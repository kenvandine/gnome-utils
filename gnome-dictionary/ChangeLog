2006-07-22  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* src/gdict-applet.c: Remove an unneeded function; use
	gtk_window_present() to give the definition window the
	keyboard focus: now the key bindings should work.

2006-07-21  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* src/gdict-applet.c:
	(window_key_press_event):
	(gdict_applet_entry_key_press_cb),
	(gdict_applet_draw): Toggle the definition window when Esc
	is pressed and the entry has focus. (#345117, reported by
	Christopher Barrington-Leigh)

2006-07-21  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* libgdict/Makefile.am: Use the ENABLE_DEBUG conditional
	to turn on debug messages at compile time.  Should really
	make everything work at runtime too, some day.

	* src/gdict-applet.c
	(window_key_press_event): Ctrl+L should return focus to the
	word entry.

	(gdict_applet_toggle_window): Shift focus when showing the
	definition window.

	(gdict_applet_lookup_end_cb),
	(gdict_applet_error_cb): Resize the definition window when
	the look up ends, for good or evil. (#346893, reported by
	Matthias Clasen et al.)

	(gdict_applet_init): Use the new gdict_get_data_dir() function.

	* gdict-common.h:
	* gdict-common.c: Add gdict_get_data_dir() to factor out
	the data dir path build code.

	* gdict-source-dialog.c:
	(transport_combo_changed_cb), (update_dialog_ui),
	(build_new_source), (gdict_source_dialog_init): Use the
	index of the transport combo box instead of the string.

2006-06-12  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* libgdict/Makefile.am: Remove wrong header files from the
	build. (Matthias Clasen, #344773)

2006-06-11  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* libgdict/gdict-speller.h:
	* libgdict/gdict-speller.c: Update the "word-activated" signal
	signature: it now includes the name of the database where the
	word was found.

	* libgdict/gdict-marshal.list: Add marshaller for the new
	"word-activated" signal signature.

	* src/gdict-window.c (gdict_window_set_word): Add a "database"
	parameter that changes the database for the word definition
	query; the change is local: the database from the source is
	kept unchanged for the following queries.

	(gdict_window_set_property), (entry_activate_cb),
	(speller_word_activated_cb), (gdict_window_drag_data_received_cb),
	(gdict_window_new): Update calls to gdict_window_set_word().

2006-06-11  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* libgdict/Makefile.am: Remove the stamp-* files when cleaning
	up.

	* TODO: Update To Do list.

2006-06-11  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* data/.cvsignore: Update CVS ignore file.
	
	* data/gnome-dictionary.desktop.in.in:
	* data/GNOME_DictionaryApplet.server.in.in: Add Bugzilla component
	version number.
	
	* data/Makefile.am: Update build.

	* data/gnome-dictionary-ui.xml: Add a View menu.

	* data/gnome-dictionary.schemas.in: Add schema for the
	"speller-visible" key.

	* data/gnome-dictionary.svg: Scalable Vector Graphics version of
	the gnome-dictionary icon.

2006-06-11  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	A src/gdict-common.h
	A src/gdict-common.c

	* src/Makefile.am:
	* src/gdict-common.h:
	* src/gdict-common.c: Refactor out some functions common to
	the application and applet.

	* src/gdict-about.c: Use the installed themed icon for the
	dictionary logo.

	* src/gdict-app.h:
	* src/gdict-app.c: Use the installed themed icon for the
	dictionary window icon; add stub code for a --match command
	line switch; 

	* src/gdict-pref-dialog.h:
	* src/gdict-pref-dialog.c: Hide the dialog on close; bind
	it to the parent widget; mimic the gdict_show_about_dialog()
	and gdict_show_source_dialog() functions; add the speller-visible
	GConf key.

	* src/gdict-applet.h:
	* src/gdict-applet.c: Use the installed themed icon for the
	dictionary window icon.

	* src/gdict-window.h:
	* src/gdict-window.c: Miscellaneous fixes; add support for
	a GdictSpeller widget.

2006-06-11  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	A libgdict/gdict-debug.[ch]
	A libgdict/gdict-private.h
	A libgdict/gdict-speller.[ch]
	A libgdict/gdict-database-chooser.[ch]
	A libgdict/gdict-strategy-chooser.[ch]

	* libgdict/gdict-utils.h:
	* libgdict/gdict-utils.c:
	* libgdict/gdict-debug.c:
	* libgdict/gdict-debug.h: Isolate gdict_debug calls and mark them
	as semi-private.

	* libgdict/gdict-private.h: Private API.

	* libgdict/gdict.h
	* libgdict/gdict-speller.h:
	* libgdict/gdict-speller.c: GdictSpeller widget.  Initial
	implementation of a widget showing matches, like the defbox
	shows definitions.

	* libgdict/gdict-database-chooser.h:
	* libgdict/gdict-database-chooser.c:
	* libgdict/gdict-strategy-chooser.h:
	* libgdict/gdict-strategy-chooser.c: Stubs for databases and
	strategies chooser widgets; not included in the build yet,
	as they are still work in progress.

2006-05-20  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* libgdict/gdict-defbox.c: Make the defbox jump to the
	beginning of the definition, instead of the middle
	of it (#341047, Michael Hofmann).

2006-05-11  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* data/Makefile.am: Install the gnome-dictionary icon inside the
	right theme directory, and make sure to rebuild the icon cache
	when done.

	* src/gdict-about.c (gdict_show_about_dialog):
	* src/gdict-app.c (gdict_init):
	* src/gdict-applet.c (gdict_app_init):
	* src/gdict-window.c (gdict_window_init): Remove the old
	pixbuf loading from the icon file, and change with calls to
	the icon name.

2006-05-06  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* libgdict/gdict-client-context.c (get_status_code): Add further
	checking for status codes.

2006-04-22  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* src/gdict-window.c (gdict_window_set_word): Avoid a coredump
	on Solaris when window->word is NULL (closes #339357, based on
	a patch by Brian Cameron).

2006-04-22  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* libgdict/gdict-client-context.c (get_status_code): Implement
	the status whitelisting: check the possible new status against
	the expected status codes before changing status; this should
	prevent moby-thes to screw up with the state machine we use
	to parse the status line (closes bug #330782 and dupes).

2006-04-17  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* data/Makefile.am: remove the french.desktop.in file from the
	build, as the dictionary server is not available anymore.

2006-04-17  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* src/gdict-app.c: Do not free the OptionContext: it'll be done by
	the GnomeProgram when it's unref'ed.

2006-04-01  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* src/gdict-app.c: Use g_option_context_set_main_group() to
	show the application's options using the --help command line
	switch (closes #335730).

2006-04-01  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* src/gdict-app.c (gdict_app_finalize): Unref the GnomeProgram
	object to avoid leakage (closes bug #335745).

2006-03-04  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* src/gdict-applet.c (gdict_applet_init): keep the applet's background
	in sync with the panel's own (patch by Michael Hoffman, closes
	bug #332035).

2006-03-03  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* src/gdict-applet.c (gdict_applet_build_window),
	(window_key_press_event_cb): allow using Esc to close the definition
	window of the applet.

	* src/gdict-window.c (set_default_size): ensure that the window is
	realized since we are going to use its GdkWindow.

2006-02-24  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* libgdict/.cvsignore:
	* data/.cvsignore: update .cvsignore with built files.

2006-02-24  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* src/gdict-applet.c (gdict_applet_create_data_dir),
	(gdict_applet_init): apply the same logic of the application to the
	applet.

2006-02-24  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* src/gdict-app.c (gdict_app_create_data_dir): remove the big
	frickin' dialog, and just rename the file that's causing the error
	by appending the '.pre-2-14' string to its name.  Let's hope this
	is enough.

2006-02-24  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* src/gdict-window.c (gdict_window_lookup_end_cb): fix ngettext()
	usage.

2006-02-24  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* src/gdict-app.c (gdict_app_init), (gdict_app_create_data_dir),
	(gdict_init): ask the user what to do if a file with the same name
	of the dictionary data dir is found; the file usually is a remnant
	of the time when the old dictionary used bonobo, and it hasn't been
	used in a while. the user has the option to remove the file, make
	a backup copy of it, or quit dictionary and manually handle the
	name clash (closes bug #331031).

2006-02-24  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* src/gdict-window.c (gdict_window_lookup_end_cb): use ngettext to
	use the correct localized plural form (patch by Gabor Kelemen,
	closes bug #332383).

2006-02-18  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* src/gdict-applet.c (show_error_dialog): check if parent is NULL
	before using it.

2006-02-11  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* libgdict/gdict-client-context.c (gdict_client_context_io_watch_cb),
	(gdict_client_context_parse_line): make the dictionary response code
	parsing a bit more robust; add a bunch of debug messages (closes
	bug #330782).

2006-02-05  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* src/gdict-app.h
	* src/gdict-app.c (gdict_app_finalize), (gdict_window_created_cb),
	(lookup_start_cb), (definition_found_cb), (lookup_end_cb),
	(gdict_look_up_word_and_quit), (gdict_init): support looking up
	multiple words from the console using the --look-up <word> command
	line switch more than once; this also works with the --no-window
	switch, for console-only output.

	* src/gdict-window.c (gdict_window_new): fill the look up entry if 
	a word is passed to the GdictWindow constructor.

	* src/gdict-about.c: update copyright date.

2006-02-05  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* src/gdict-window.c (gdict_window_set_word), (entry_activate_cb),
	(gdict_window_drag_data_received_cb), (gdict_window_new): if a word is
	passed to the GdictWindow constructor it'll be search automatically,
	instead of requiring the user to confirm by pressing enter.

2006-02-05  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* src/gdict-applet.c (gdict_applet_finalize): really commit the removal
	of the idle loop.

2006-02-05  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* src/gtkalignedwindow.c (gtk_aligned_window_class_init),
	(gtk_aligned_window_realize), (gtk_aligned_window_map),
	(gtk_aligned_window_show), (gtk_aligned_window_position): make the
	window align on realization and re-align every show request; also,
	set the gravity for the window manager to pick up.

2006-02-05  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* src/gdict-applet.c (gdict_applet_finalize): force the removal of
	the idle loop, in case the finalization function is called when the
	idle loop is still running.

2006-02-05  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* src/gdict-app.c (gdict_app_init): remove callback to the "die"
	signal (closes bug #329911).

2006-02-04  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* src/gdict-app.c (gdict_app_init): check whether there is a file
	with the same name of the data directory under $HOME/.gnome2, and
	warn the user to move it away; the file seems to be a left-over
	from older versions of Gnome (early 2.0, probably), so it
	shouldn't bother us that much (closes bug #329126).

	* src/gdict-applet.c (gdict_applet_init): ditto.

2006-01-28  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	Add support for the document_font_name key into the Dictionary
	application and applet.  This setting is desktop-wide, and should be
	honoured by every application showing arbitrarily long text to the
	user.

	* libgdict/gdict-defbox.[ch] (gdict_defbox_set_font_name),
	(gdict_defbox_get_font_name): add a "font-name" property and its
	accessors; this property modifies the font of the defbox, since we
	cannot simply do gtk_widget_modify_font on the defbox itself.

	* src/gdict-pref-dialog.h: add
	
	  /desktop/gnome/interface/document_font_name
	  
	to the list of recognized keys; also add a default font for the
	Defbox ("Sans 10").

	* src/gdict-window.h:
	* src/gdict-window.c (gdict_window_finalize),
	(gdict_window_set_defbox_font), (gdict_window_set_property),
	(gdict_window_get_property), (gdict_window_gconf_notify_cb),
	(set_window_default_size), (gdict_window_constructor),
	(gdict_window_class_init), (gdict_window_init): use the font size
	inside the "document_font_name" GConf key for the defbox; add a
	"defbox-font" property to GdictWindow; use the font of the GdictDefbox
	widget to calculate the window geometry, now that the window and the
	defbox widgets might have two different font descriptions; get
	notification from eventual errors while connecting to GConf.

	* src/gdict-applet.c (gdict_applet_set_defbox_font),
	(gdict_applet_gconf_notify_cb), (gdict_applet_finalize),
	(gdict_applet_init), (set_default_size): use the font size inside
	the "document_font_name" GConf key for the defbox; use the font of
	the GdictDefbox widget to calculate the window geometry, now that
	the window and the defbox widgets might have two different font
	descriptions; get notification from eventual errors while connecting to
	GConf.

2006-01-23  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* src/gdict-applet.c (gdict_applet_init): fix stupid typo.

	* libgdict/gdict-source-loader.c: remove unnecessary cast.

2006-01-22  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* src/gdict-applet.c (gdict_applet_init):
	* src/gdict-app.c (gdict_app_init): fix error reporting.

2006-01-22  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* src/gdict-window.c (set_window_default_size),
	(gdict_window_style_set): port the size allocation code from the applet
	to the main application, since it's a bit clearer.

2006-01-22  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* src/gdict-applet.c (set_window_default_size),
	(gdict_applet_build_window), (gdict_applet_style_set): re-work the
	size calculation of the applet's window: now it should be multi-head
	aware (I don't have the hardware, so I really can't test it) and it
	has an upper bound limited to the monitor size.  Also, it should be
	a little bit wider by default.

2006-01-16  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* data/gnome-dictionary.schemas.in: fix a typo in the
	default-window-height key long comment.

2006-01-16  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* src/gdict-window.c (gdict_window_error_cb): remove the busy cursor in
	case of error.

2006-01-16  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* libgdict/gdict-context.c
	* libgdict/gdict-client-context.c
	* libgdict/gdict-defbox.c: use the new and faster g_slice_* calls from
	GLib HEAD in place of g_new.

	* libgdict/gdict-context.c: add the gtk-doc markings to the last
	missing functions.

2006-01-15  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	A data/french.desktop.in
	A data/spanish.desktop.in

	* data/french.desktop.in: add a source definition file for a
	French-based dictionary source.

	* data/spanish.desktop.in: add a source definition file for a
	Spanish-based dictionay source.

	* data/Makefile.am: add the two new dictionary sources.

2006-01-13  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* src/gdict-applet.c (gdict_applet_init), (gdict_applet_factory):
	move the menu items sensitivity set inside the applet's factory; this
	should close bug #326004 which was triggered if there was a delay
	in the creation of the bonobo ui control.

2006-01-13  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* src/gdict-applet.c (gdict_applet_set_menu_sensitive),
	(gdict_applet_lookup_start_cb), (gdict_applet_lookup_end_cb),
	(gdict_applet_error_cb), (gdict_applet_init): add a function
	to make the menu items sensitive.

	* src/gdict-applet.c (gdict_applet_style_set): re-compute the
	definition window size request depending on the font size at every
	style change.

	* src/gdict-applet.c (gdict_applet_draw), (gdict_applet_init),
	(gdict_applet_build_window): remove the warnings (they wouldn't be
	displayed anyway) and use error dialogs; mark new strings as
	translatable; add tooltips for the applet widgets.

2006-01-12  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* libgdict/Makefile.am: fixed the enum generation.

2006-01-11  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* data/GNOME_DictionaryApplet.xml: change the mnemonic for the "Clear"
	verb.

	* src/gdict-applet.c (gdict_applet_lookup_end_cb),
	(gdict_applet_error_cb), (gdict_applet_init): check before changing the
	menu items' sensivity; this should fix the crasher in bug #326004.

2006-01-11  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* data/gnome-dictionary.schemas.in: add the new window state keys:
		default-window-height
		default-window-width
		window-is-maximized
	these keys will store the window state across sessions.

	* libgdict/Makefile.am: fix a bug that prevented the right inclusion
	of the headers inside the auto-generated gdict-enum-types.h header
	file.

	* src/gdict-applet.c (gdict_applet_build_window): create the window
	showing the defbox using width and height calculated from the font
	size.

	* src/gdict-applet.c (gdict_applet_icon_toggled_cb),
	(gdict_applet_button_press_event_cb),
	(gdict_applet_icon_button_press_event_cb), (gdict_applet_draw),
	(gdict_applet_lookup_start_cb), (gdict_applet_size_allocate): use a
	ToggleButton instead of a plain Image for the dictionary icon; this
	should make the window toggling a bit more discoverable.  Also, moved
	back the icon before the entry: the window should use it as the
	"attach" widget, as it resizes its height with the panel, while the
	entry does not.

	* src/gdict-pref-dialog.h: add the new GConf keys

	* src/gdict-window.c (gdict_window_finalize: remove the GConf
	notification listener before destroying the window.

	* src/gdict-window.c (gdict_window_cmd_file_new),
	(gdict_window_cmd_file_close_window), (gdict_window_delete_event_cb),
	(gdict_window_state_event_cb), (gdict_window_gconf_notify_cb),
	(gdict_window_size_allocate), (gdict_window_style_set),
	(gdict_window_constructor), (gdict_window_class_init),
	(gdict_window_init): make the window "recall" its size and state
	through sessions using the newly added GConf keys; fallback to the
	font-based size allocation on user request or if no value was
	found (based on the similar code used by Dennis Cranston in
	gsearchtool, closes bug #325887).

	* src/gdict-window.h: add new window state variables.

2005-01-02  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* src/gdict-app.h:
	* src/gdict-app.c: enable look up via command-line (closes bug
	#325014).

2005-01-02  Emmanuele Bassi  <ebassi@cvs.gnome.org> 

	* src/gdict-app.c: (gdict_app_init): Set execute bit (0700).
	* src/gdict-applet.c: (gdict_applet_init):  Set execute bit (0700).
	* src/gdict-pref-dialog.c: (source_remove_clicked_cb): UI fix
	for remove source confirmation dialog (patch by Dennis Cranston, fixes
	bug #325455).

2005-12-31  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* src/gdict-window.c (gdict_window_help_contents_cmd): remove the help
	document id.

2005-12-31  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* data/GNOME_DictionaryApplet.server.in.in: update Bugzilla product to
	"gdict-applet", to disambiguate the applet from the main application;
	update the icon name to the new icon.

	* src/gdict-applet.c: fix the applet and make it work again.

	* src/gdict-pref-dialog.c (response_cb),
	(gdict_pref_dialog_init): intercept the HELP response code and show
	the help without closing the dialog.

2005-12-31  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* data/gnome-dictionary-preferences.glade:  HIG fixes for
	the add source dialog.  Do not use bold labels.  Use left
	alignment for labels.  Fix the 'H' key mnemonic conflict.  
	Use sentence capitalization for the expander label and indent 
	its contents (patch by Dennis Cranston, closes bug #325340).

2005-12-30  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* data/gnome-dictionary.1: final touches to the man page.

2005-12-30  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* src/gdict-pref-dialog.c (font_button_font_set_cb),
	(gdict_pref_dialog_gconf_notify_cb): brown paper bag fix for
	propagating the print font through GConf (while avoiding loops).

2005-12-30  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* src/gdict-pref-dialog.c (font_button_font_set_cb): tighter checks on
	the fonts to prevent a segmentation fault.

2005-12-30  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* src/gdict-source-dialog.c (gdict_source_dialog_constructor): switch
	the cancel and add buttons.

2005-12-30  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* libgdict/gdict-client-context.c
	(gdict_client_context_lookup_server): make the hostname lookup cache
	expire after five minutes; this should tentatively solve bug #169915.

2005-12-30  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	Re-sync with my development trunk: add the new source dialog code; fix
	a slew of typos and a serious crasher; more UI fixes.

	A data/gnome-dictionary.png
	A src/gdict-source-dialog.h
	A src/gdict-source-dialog.c

	* libgdict/gdict-entry.c,
	src/gdict-pref-dialog.c,
	src/gdict-about.c,
	src/gdict-app.c,
	src/gdict-applet.c: fix some typos.

	* src/gdict-window.c (gdict_window_class_init): we don't need
	translatable properties, here.

	* src/Makefile.am: add gdict-source-dialog.[ch] to the build.

	* src/gdict-pref-dialog.c,
	src/gdict-source-dialog.h,
	src/gdict-source-dialog.c: move out the
	source dialog into its own file; make it flexible enough to allow
	further expansion when sources view and editing will be added.

	* src/gdict-about.c: add support for the new icon.

	* libgdict/gdict-context.c: add documentation

	* data/gnome-dictionary.1: update the man page.

	* data/gnome-dictionary-preferences.glade: update the UI for the
	source dialog.

	* src/gdict-about.c,
	src/gdict-app.c,
	src/gdict-applet.c,
	src/gdict-window.c,
	src/gdict-window.h: add support for the new icon.
	
	* data/gnome-dictionary.desktop.in: add the new icon
	
	* data/gnome-dictionary.png: new icon for the dictionary.

	* data/Makefile.am: add the appicon target

	* libgdict/gdict-defbox.c (create_progress_dialog): UI fixes (patch
	from Dennis Cranston, closes bug #324860).
	
	* src/gdict-window.c (gdict_window_lookup_start_cb), 
	(gdict_window_lookup_end_cb), (entry_activate_cb), 
	(gdict_window_drag_data_received_cb):  Fix a couple regressions:
	1) change window title format to "word - App Name" per HIG.
	2) display a busy cursor while looking up words (patch from Dennis
	Cranston, closes bug #324860).

	* src/gdict-window.c (gdict_window_error_cb), (gdict_window_set_word),
	(entry_activate_cb), (gdict_window_drag_data_received_cb): fix a
	double-free bug triggered by a failed look up (patch from Paolo
	Borelli, closes bug #325238).

2005-12-25  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	The "Maybe this Christmas" release.  This release marks the end of the
	big UI and feature changes: from now on, it's fixes time until the next
	development cycle.  Merry Christmas everyone.

	* src/gdict-print.c: fix compiler warnings about parameter signedness.

	* data/gnome-dictionary-preferences.glade: update the source add dialog
	with a new UI.

	* docs/reference/gdict/gdict-decl-list.txt: add
	gdict_defbox_set_database() and gdict_defbox_get_database() to the
	declarations list.

	* src/gdict-about.c: use "Look up".

	* src/gdict-app.c (gdict_app_init): create the data directory inside
	$HOME/.gnome2 when creating the application singleton.

	* src/gdict-applet.c (gdict_applet_init): ditto.

	* src/gdict-pref-dialog.c: add the source add dialog, and enable the
	source remove code: now the user can create new dictionary sources
	without having to actually drop a file inside the data directory.  The
	code is still a bit flaky, but this closes all the UI/feature work for
	the release.

	* src/gdict-window.c (gdict_window_cmd_help_contents): fix error
	message.

2005-12-21  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* src/gdict-window.c: fix a bunch of compiler warnings (patch by
	Kjartan Maraas, closes	bug #324552).

	* src/gtkalignedwindow.c (gtk_aligned_window_finalize),
	(gdict_aligned_window_get_widget): ditto.

	* src/main.c: include libintl.h.
	
	* src/gdict-applet.c (gdict_applet_init),
	(gdict_applet_gconf_notify_cb): hook up the notification callback and
	monitor the database and strategy keys.

	* src/gdict-app.c (gdict_window_destroy_cb), (gdict_init),
	(gdict_main): fix compiler warnings (patch by Kjartan Maraas, closes
	bug #324552).

	* src/gdict-about.c: use "Look up" instead of "Lookup".

	* README: remove the warnings.

2005-12-19  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* libgdict/Makefile.am: fix stamp_files build

2005-12-19  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* libgdict/gdict-defbox.c (create_find_pane): another shot at getting
	the find pane layout right (closes bug #324342).

2005-12-19  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* data/GNOME_DictionaryApplet.server.in.in: add the old GDict applet
	OAFIID to the .server file, for backward compatibility.

	* data/GNOME_DictionaryApplet.xml: add the "Save" verb.

	* data/gnome-dictionary-preferences.glade: remove the _ char from the
	notebook tab labels.

	* libgdict/gdict-defbox.c (gdict_defbox_find_forward),
	(find_next_clicked_cb), (find_entry_changed_cb): add support for
	find-as-you-type search.

	* libgdict/gdict-defbox.c (gdict_defbox_default_constructor): remove
	word wrapping from the TextView widget.

	* libgdict/gdict-defbox.c (lookup_end_cb): explicitely move the cursor
	to the beginning of the definition text.

	* src/gdict-applet.c: implement the popup menu callbacks; support the
	"database" and "strategy" options; add a "Save" button to the
	definition window; add ATK names and descriptions to the applet
	widgets; add a gdict_applet_queue_draw() for drawing the applet inside
	an idle loop; remove debug code; handle the definition window and menu
	items visibility depending on what the query results are; port
	preferences setting functions from GdictWindow.

	* src/gdict-window.c (gdict_window_style_set),
	(gdict_window_constructor), (gdict_window_init): make the default size
	of the window depend on the display font size, in order to show the
	pre-formatted text coming from a dictionary server.

2005-12-19  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* data/gnome-dictionary-preferences.glade: use "Source" and "Print" as
	notebook tab label strings, and mark them translatable.

2005-12-19  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* docs/reference/gdict/gdict-sections.txt: add new functions.

2005-12-19  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	Another set of UI patches.

	* libgdict/gdict-defbox.c (find_prev_clicked): UI fixes.

	* libgdict/gdict-defbox.c (create_find_pane): fix find pane layout.

	* data/gnome-dictionary-preferences.glade:
	* src/gdict-pref-dialog.c (source_add_clicked_cb),
	(gdict_pref_dialog_init):  HIG related fixes such as
	mnemonics, widget spacing, etc. (Patch by Dennis Cranston).

2005-12-18  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* src/gdict-window.c: use the "database" property, and hook it up to
	GConf.

	* libgdict/gdict-defbox.h, libgdict/gdict-defbox.c: add the "database"
	property; add the gdict_defbox_set_database() and
	gdict_defbox_get_database() accessors for the "database" property.

2005-12-17  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	A bunch UI fixes from Dennis Cranston, and a bunch of fixes triggered
	by a down of dict.org.

	* libgdict/gdict-defbox.c, src/gdict-window.c: fix lifetime of the
	GdictContext and related signal handlers.

	* libgdict/gdict-client-context.c (gdict_client_context_finalize),
	(clear_command_queue): fix a double free bug issued when finalizing a
	ClientContext with a non-empty queue (patch by Paolo Borelli).

	* libgdict/gdict-client-context.c: emit "error" when unable to connect
	to the dictionary server.

	* libgdict/gdict-defbox.c:  UI fixes for the find widgets (patch by
	Dennis Cranston).

	* src/gdict-window.c:  UI fixes.  Fix widget spacing.  Change 
	"find" back to "look up" to avoid confusion caused by its 
	double use (patch by Dennis Cranston).

	* libgdict/gdict-source.c: fix the "context" propery;

	* src/gdict-window.c: add "source-name" and "word" constructor
	properties, so that a window might be created with a pre-defined
	source and word to look up.

	* libgdict/gdict-app.c (gdict_create_window),
	(gdict_window_created_cb), (gdict_window_destroy_cb): fix multiple
	registration of callbacks and remove the loop on the windows list for
	good (based on a patch by Paolo Borelli).

	* src/gdict-app.c: begin command line arguments support, and attach
	a GOptionContext to gnome_program_init().

2005-12-15  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* src/gdict-applet.h, src/gdict-applet.c: create the dictionary applet.

	* src/gdict-app.c: do not leak the GOptionContext.

	* libgdict/gdict-client-context.c (gdict_client_context_parse_line):
	add more debug messages; do not tokenize the line, but walk it.

	* libgdict/gdict-client-context.c (get_status_code): make the
	status code check more robust (too many false positives).

	* libgdict/gdict-defbox.c: make the error checking a bit more robust.

	* data/gnome-dictionary.schemas.in: mark the following keys as
	obsolete and deprecated:

		- server
		- port
		- smart
	
	and add the following keys:

		- source-name
		- print-font
	
	* data/default.desktop.in: don't mark the Name key as translatable.

	* libgdict/gdict-source-loader.h, libgdict/gdict-source-loader.c: add
	gdict_source_loader_remove_source() and gdict_source_loader_update();
	the former removes a dictionary source file and the latter forces an
	update of the sources list.

	* src/gdict-print.h, src/gdict-print.c: remove the print-related
	stuff from gdict-window in order to use them inside the applet.

	* src/gdict-pref-dialog.c, src/gdict-pref-dialog.h: create the
	GdictPrefDialog widget; this dialog will be used to handle the
	preferences for both the application and the applet.  You can
	change the active dictionary source and the print font; missing
	bits: add a new source (create a new GdictSource and dump it
	into a tmpfile inside .gnome2/gnome-dictionary) and remove a
	source (the code is already in place, but compiled out until the
	add source stuff is in).

	* data/gnome-dictionary-preferences.glade: create the UI for
	the preferences dialog.

	* libgdict/gdict-source.h, libgdict/gdict-source.c: add the
	"database" and "strategy" properties to GdictSource, and relative
	accessor functions; these properties set the default database and
	strategy used for a dictionary source; implement the API for
	creating a dictionary source: the output is in form of a string,
	it'll be up to the caller to create an actual file; make the Name
	key not localizable: it's the unique identifier for the source, and
	the user should only see the content of the Description key.

	* src/gdict-window.c: add a footer line when printing, and fix the
	page counting; add the help link; add GConf support.

2005-12-10  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* libgdict/gdict-client-context.c (gdict_client_context_parse_line):
	avoid emission of spurious "lookup-end" signals; rework the server
	error response parsing.

	* libgdict/gdict-defbox.c: grab focus on the find entry when showing
	the find pane; add a progress dialog for showing the state of the
	definition lookup.

	* data/gnome-dictionary-ui.xml, src/gdict-window.h, src/gdict-window.c:
	add support for a <control>L accelerator, used to highlight the "Find"
	entry; add a mnemonic for the "Find" entry; add a status bar; link the
	GdictContext signals; various bug fixes.

2005-12-09  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* libgdict/gdict-source.h: add gdict_source_peek_context() and
	gdict_source_steal_context().

	* libgdict/gdict-source.c (gdict_source_get_context): create a new
	context each time; the old behaviour has been shifted to the
	gdict_source_peek_context() function.

	* src/gdict-window.h, src/gdict-window.c: add the "created" signal,
	which is fired each time a new GdictWindow has been created by another
	GdictWindow.

	* src/gdict-window.c (gdict_window_cmd_file_new): create a new
	GdictWindow instance, and fire the "created" signal.

	* src/gdict-app.c: use the GdictWindow::created signal to add the newly
	created window to the windows list, like we use the GtkWidget::destroy
	signal to remove GdictWindow instances from the list.

2005-12-09  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* help/C/gnome-dictionary.xml: fix manual stub, so that make check
	passes.

2005-12-09  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* src/gdict-window.h, src/gdict-window.c: move GdictWindow into its own
	file; add printing support (still experimental).

	* src/gdict-app.h, src/gdict-app.c: remove GdictWindow

	* .cvsignore, data/.cvsignore, src/.cvsignore: add cvs ignore files.

	* libgdict/gdict-defbox.c: clear content on error.

2005-12-07  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* README: add a visible warning on the experimental nature of this
	branch; add some build tips.

	* TODO: update list.

2005-12-07  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* data/Makefile.am: add gnome-dictionary-ui.xml, the GtkUIManager
	definitions of the menu bar and accelerators.

	* docs/source-configuration.txt: add Database and Strategy keys.

	* libgdict/gdict-client-context.c: add "total" property support for
	GdictDefinition.

	* libgdict/gdict-context-private.h,
	libgdict/gdict-context.c,
	libgdict/gdict-context.h: add "total" property, and change
	GdictDefintion ctor (we don't need a word).

	* libgdict/gdict-defbox.h, libgdict/gdict-defbox.h: add
	gdict_defbox_new_with_context() ctor; add new API to wrap around
	GtkTextView/GtkTextBuffer.

	* libgdict/gdict-source.c, libgdict/gdict-source-loader.c: fix bugs
	inside the GdictSource and GdictSourceLoader.

	* libgdict/gdict-source.h: add gdict_source_load_from_data().

	* libgdict/gdict-utils.c: remove title from the error dialog, as per
	HIG; fix a stupid bug in get_toplevel_window().

	* src/Makefile.am: remove the applet data, since we don't have any code
	for it, yet.

	* src/gdict-app.h, src/gdict-app.c: begin Dictionary UI; GdictWindow is
	a GtkWindow subclass; GdictApp is a singleton object, holding all the
	windows.

	* src/gdict-about.h, src/gdict-about.c: add a simple wrapper around
	GtkAboutDialog.

	* src/main.c: main application launcher.

2005-11-29  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* libgdict/gdict-defbox.c: fix forward/backward searching.

2005-11-29  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* libgdict/Makefile.am: add LIBGLADE_* macros to the application and
	applet CFLAGS

	* libgdict/gdict-utils.[ch]: add gdict_show_error_dialog() and the
	gdict_show_gerror_dialog() functions for showing error message dialogs.

	* libgdict/gdict-defbox.[ch]: begin re-implementation of the
	GdictDefbox widget.  This widget is used to show the definitions
	retrieved by a GdictContext implementation.

	* libgdict/test-defbox.c: test case for GdictDefbox.

2005-11-24  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* data/default-dictionary.desktop.in: remove translatable mark to
	the Name key: this is the default, and should always be accessed using
	the "Default" name.

	* libgdict/Makefile.am: fix CLEANFILES and DISTCLEANFILES.

	* libgdict/gdict-source.c, libgdict/gdict-source-loader.c: fix stupid
	bugs.

	* libgdict/test-source.c: add test suite for GdictSource and
	GdictSourceLoader.

	* libgdict/Makefile.am: add test-source.c

	* libgdict/.cvsignore: add test-source.

	* libgdict/gdict-preferences.[ch]: remove these files.

2005-11-22  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* libgdict/.cvsignore: add .cvsignore

	* libgdict/test-defbox.c: add (empty) test suite for GdictDefbox.

	* libgdict/test-entry.c: add test suite for GdictEntry.

	* libgdict/gdict-source-loader.[hc]: add GdictSourceLoader, an object
	for loading all the dictionary source files.

	* libgdict/gdict-source.[hc]: add GdictSource, an object for loading
	the right GdictContext based on .desktop files.

	* libgdict/Makefile.am: add new files to the build.

	* data/default-dictionary.desktop.in: default dictionary source for
	dict.org.

	* data/Makefile.am: add default-dictionary.desktop.in and i18n rule for
	translation support.

	* libgdict/gdict-version.h.in: add versioning to libgdict
	
	* libgdict/gdict.h: include gdict-version.h

	* TODO: update list

2005-11-21  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	* libgdict/gdict-client-context.c
	(gdict_client_context_real_connected),
	(gdict_client_context_force_disconnect),
	(gdict_client_context_lookup_server): fix comments

	* libgdict/gdict-client-context.c
	(gdict_client_context_parse_line): fix the "lookup-end" signal
	emission.

	* libgdict/test-client.c: add callbacks for the lookup-start and
	lookup-end signals

2005-11-21  Emmanuele Bassi  <ebassi@cvs.gnome.org>

	Initial import of gnome-dictionary.

	* libgdict/*: the GdictContext interface and GdictClientContext class
	are basically done; GdictClientContext implements a RFC2229-compliant
	client for a dictionary server using the dictionary protocol.
